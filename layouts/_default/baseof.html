<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
    {{ partial "head.html" . }}
    <body class="bg-whiteSmoke">
        {{ partial "header.html" . }}
        <main class="pt-[68px]">
            {{ block "main" . }}{{ end }}
        </main>
        {{ partial "footer.html" . }}
        <div id="cookie-modal" data-modal-backdrop="static" tabindex="-1" aria-hidden="true" class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 justify-center items-center w-full md:inset-0 h-[calc(100%-1rem)] max-h-full">
            <div class="relative p-4 w-full max-w-2xl max-h-full">
                <div class="relative bg-gray-900 border border-gray-700 rounded-2xl shadow-2xl p-5 md:p-7 text-white">
                    <div class="flex items-center justify-between border-b border-gray-700 pb-4 md:pb-5">
                        <h3 class="text-xl font-semibold">Privacy &amp; Cookie Preferences</h3>
                        <button type="button" class="text-gray-400 bg-transparent hover:bg-gray-800 hover:text-white rounded-lg text-sm w-9 h-9 ms-auto inline-flex justify-center items-center" id="cookie-close">
                            <svg class="w-5 h-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18 18 6m0 12L6 6"/></svg>
                            <span class="sr-only">Close modal</span>
                        </button>
                    </div>
                    <div class="space-y-4 md:space-y-6 py-4 md:py-6">
                        <p class="text-gray-200 text-base leading-relaxed">
                            We use essential cookies to make this site work. With your consent, we also use analytics cookies to improve performance and better understand how visitors use this site. You can change your preference at any time.
                        </p>
                        <p class="text-gray-200 text-base leading-relaxed">
                            This experience is designed to comply with GDPR, CCPA, and other major privacy regulations. Read our <a href="/privacy-policy/" class="text-primary-300 underline">Privacy Policy</a> and <a href="/terms-and-conditions/" class="text-primary-300 underline">Terms &amp; Conditions</a> for more details.
                        </p>
                    </div>
                    <div class="flex flex-col gap-3 border-t border-gray-700 pt-4 md:flex-row md:items-center md:justify-end md:space-x-4">
                        <button id="cookie-decline" type="button" class="w-full text-white border border-gray-600 hover:bg-gray-800 rounded-full text-sm font-medium px-5 py-2.5 focus:outline-none focus:ring-2 focus:ring-gray-700">Decline Optional</button>
                        <button id="cookie-accept" type="button" class="w-full text-white bg-primary-600 hover:bg-primary-700 focus:ring-4 focus:ring-primary-400 rounded-full text-sm font-medium px-5 py-2.5 focus:outline-none">Accept All</button>
                    </div>
                </div>
            </div>
        </div>
        <button id="cookie-manage" class="cookie-manage-btn hidden" type="button">Cookie Preferences</button>
        <script src="https://cdn.jsdelivr.net/npm/flowbite@2.4.1/dist/flowbite.min.js"></script>
        <script>
            (function () {
                const modalEl = document.getElementById('cookie-modal');
                const manageBtn = document.getElementById('cookie-manage');
                const acceptBtn = document.getElementById('cookie-accept');
                const declineBtn = document.getElementById('cookie-decline');
                const closeBtn = document.getElementById('cookie-close');
                if (!modalEl || !manageBtn || !acceptBtn || !declineBtn || !window.Modal) return;

                const modal = new Modal(modalEl, { backdrop: 'static', closable: false });

                const openModal = () => {
                    modal.show();
                    manageBtn.classList.add('hidden');
                };
                const closeModal = () => {
                    modal.hide();
                    manageBtn.classList.remove('hidden');
                };
                const saveConsent = (value) => {
                    localStorage.setItem('cookieConsent', value);
                    window.cookieConsent = value;
                    if (value === 'accepted' && typeof window.loadAnalytics === 'function') {
                        window.loadAnalytics();
                    }
                };

                const storedConsent = localStorage.getItem('cookieConsent');
                if (!storedConsent) {
                    openModal();
                } else {
                    manageBtn.classList.remove('hidden');
                }

                acceptBtn.addEventListener('click', () => {
                    saveConsent('accepted');
                    closeModal();
                });

                declineBtn.addEventListener('click', () => {
                    saveConsent('declined');
                    closeModal();
                });

                manageBtn.addEventListener('click', () => {
                    openModal();
                });

                closeBtn.addEventListener('click', () => {
                    saveConsent(localStorage.getItem('cookieConsent') || 'declined');
                    closeModal();
                });
            })();
        </script>
    </body>
</html>
